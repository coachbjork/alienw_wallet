import{s as z,e as g,c as h,a as S,d as p,m as f,i as L,f as v,n as C,u as M,h as q,o as B,t as P,j as $,b as R,l as W,S as D,r as Z}from"./scheduler.B2jyPd1j.js";import{A as _,m as u,q as b,e as N,c as A,d as w}from"./bundle-mjs.DomUkUPd.js";import{S as j,i as K}from"./index.Csg-1y_2.js";import{_ as m,a as y,g as O,c as x,v as U}from"./session.BbujRMuR.js";async function X(o){var l;const s=((l=m.find(_,n=>n.name===o))==null?void 0:l.scope)||"";return(await y(u.CONTRACT_NAME,s,u.TABLES.DACGLOBALS)).data}async function Y(o,s){var n;const r=((n=m.find(_,t=>t.name===o))==null?void 0:n.scope)||"";return await y(u.CONTRACT_NAME,r,u.TABLES.VOTES,s)}async function ee(o,s){var n;const r=((n=m.find(_,t=>t.name===o))==null?void 0:n.scope)||"";return await y(b.CONTRACT_NAME,r,b.TABLES.STAKES,s)}async function te(o){var t;const s=((t=m.find(_,e=>e.name===o))==null?void 0:t.scope)||"",r=await O(u.CONTRACT_NAME,s,u.TABLES.CANDIDATES);return(await x(r)).filter(e=>parseInt(e.is_active.value)===1).map(e=>{let a=U(`${String(e.avg_vote_time_stamp)}Z`,e.total_vote_power);const c=parseInt(e.total_vote_power)/1e4;let i=c;return a<=0?a=0:(a=100-a/e.total_vote_power*100,a=Math.round(a*100)/100,i=c-c*a/100),{candidate_name:String(e.candidate_name),requestedpay:String(e.requestedpay),rank:parseInt(e.rank),gap_filler:parseInt(e.gap_filler),total_vote_power:c,is_active:parseInt(e.is_active),number_voters:parseInt(e.number_voters),avg_vote_time_stamp:`${String(e.avg_vote_time_stamp)}Z`,running_weight_time:parseInt(e.running_weight_time),vote_decay:a,current_vote_power:i}}).sort((e,a)=>a.rank-e.rank)}async function T(o){var t;const s=((t=m.find(_,e=>e.name===o))==null?void 0:t.scope)||"",r=await O(u.CONTRACT_NAME,s,u.TABLES.CUSTODIANS1);return(await x(r)).map(e=>({cust_name:String(e.cust_name),requestedpay:String(e.requestedpay),total_vote_power:parseInt(e.total_vote_power),rank:parseInt(e.rank),number_voters:parseInt(e.number_voters),avg_vote_time_stamp:`${String(e.avg_vote_time_stamp)}Z`})).sort((e,a)=>a.rank-e.rank)}function k(o,s,r){const l=o.slice();return l[2]=s[r],l}function I(o){let s,r,l=o[2].name+"",n,t,e,a,c;return{c(){s=g("li"),r=g("span"),n=P(l),t=$(),this.h()},l(i){s=h(i,"LI",{class:!0});var d=S(s);r=h(d,"SPAN",{class:!0});var E=S(r);n=R(E,l),E.forEach(p),t=W(d),d.forEach(p),this.h()},h(){f(r,"class","text-default text-lg md:text-xl svelte-1i7gnzw"),f(s,"class",e=D(o[0].name===o[2].name?"active":"")+" svelte-1i7gnzw")},m(i,d){L(i,s,d),v(s,r),v(r,n),v(s,t),a||(c=Z(r,"click",o[1](o[2])),a=!0)},p(i,d){o=i,d&1&&e!==(e=D(o[0].name===o[2].name?"active":"")+" svelte-1i7gnzw")&&f(s,"class",e)},d(i){i&&p(s),a=!1,c()}}}function V(o){let s,r,l=N(_),n=[];for(let t=0;t<l.length;t+=1)n[t]=I(k(o,l,t));return{c(){s=g("div"),r=g("ul");for(let t=0;t<n.length;t+=1)n[t].c();this.h()},l(t){s=h(t,"DIV",{class:!0});var e=S(s);r=h(e,"UL",{class:!0});var a=S(r);for(let c=0;c<n.length;c+=1)n[c].l(a);a.forEach(p),e.forEach(p),this.h()},h(){f(r,"class","grid grid-cols-3 justify-center p-1 md:flex md:flex-row md:flex-wrap svelte-1i7gnzw"),f(s,"class","planet_menu mx-5 rounded-xl border border-indigo-500 svelte-1i7gnzw")},m(t,e){L(t,s,e),v(s,r);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(r,null)},p(t,[e]){if(e&3){l=N(_);let a;for(a=0;a<l.length;a+=1){const c=k(t,l,a);n[a]?n[a].p(c,e):(n[a]=I(c),n[a].c(),n[a].m(r,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=l.length}},i:C,o:C,d(t){t&&p(s),M(n,t)}}}function F(o,s,r){let l;q(o,A,t=>r(0,l=t)),B(async()=>{if(l){const t=await T(l.name);w.set(t)}else{A.set(_[0]);const t=await T(_[0].name);w.set(t)}});function n(t){return async()=>{A.set(t);const e=await T(t.name);w.set(e)}}return[l,n]}class ae extends j{constructor(s){super(),K(this,s,F,V,z,{})}}export{ae as P,te as a,Y as b,ee as c,X as g};
